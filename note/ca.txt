创建私钥
openssl genrsa -out ca/ca-key.pem 2048

创建证书请求
openssl req -new -out ca/ca-req.csr -key ca/ca-key.pem

自签署证书
openssl x509 -req -in ca/ca-req.csr -out ca/ca-cert.pem -signkey ca/ca-key.pem -days 3650

转换证书格式
openssl pkcs12 -export -clcerts -in ca/ca-cert.pem -inkey ca/ca-key.pem -out ca/ca.p12

--------------------
生成server证书

创建私钥
openssl genrsa -out server/server-key.pem 2048

创建证书请求
openssl req -new -out server/server-req.csr -key server/server-key.pem -subj "/C=CN/ST=Shanghai/L=Shanghai/O=luck/OU=luck/CN=drill.cn/emailAddress=luck@drill.cn"

自签署证书
openssl x509 -req -in server/server-req.csr -out server/server-cert.pem -signkey server/server-key.pem -CA ca/ca-cert.pem -CAkey ca/ca-key.pem -CAcreateserial -days 3650

转换证书格式
openssl pkcs12 -export -clcerts -in server/server-cert.pem -inkey server/server-key.pem -out server/server.p12

-------------------
生成 client 证书
创建私钥
openssl genrsa -out client/client-key.pem 2048

创建证书请求
openssl req -new -out client/client-req.csr -key client/client-key.pem -subj "/C=CN/ST=Shanghai/L=Shanghai/O=luck/OU=luck/CN=drill.cn/emailAddress=luck@drill.cn"

自签署证书
openssl x509 -req -in client/client-req.csr -out client/client-cert.pem -signkey client/client-key.pem -CA ca/ca-cert.pem -CAkey ca/ca-key.pem -CAcreateserial -days 3650

转换证书格式
openssl pkcs12 -export -clcerts -in client/client-cert.pem -inkey client/client-key.pem -out client/client.p12

--------------
根据 ca 证书生成 jks 文件
keytool -keystore jks/truststore.jks -keypass luckluck -storepass luckluck -alias ca -import -trustcacerts -file ca/ca-cert.pem

keytool -keystore jks/truststore.jks -alias ca -import -trustcacerts -file ca/ca-cert.pem

--------------
tomcat 使用证书
tips : 两 个 storefile 的 路 径 一 定 要 对 ，不 然 会 落 泪

<Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
    maxThreads="150" scheme="https" secure="true"
    clientAuth="true" sslProtocol="TLS"
    keystoreFile="/root/ca/server/server.p12" keystorePass="luckluck" keystoreType="PKCS12"
    truststoreFile="/root/ca/jks/truststore.jks" truststorePass="luckluck" truststoreType="JKS"/>

<Connector port="8443" protocol="HTTP/1.1"
        maxThreads="150" SSLEnabled="true"
        scheme="https" secure="true" clientAuth="false" sslProtocol="TLS"
        keystoreFile="/root/ca/server/server.p12"
        keystoreType="PKCS12" keystorePass="luckluck" \>


将ca.p12，client.p12分别导入到IE中去（打开IE->Internet选项->内容->证书）。
ca.p12导入至受信任的根证书颁发机构，client.p12导入至个人。